{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{\"1GYG\":function(e,t,n){\"use strict\";var a=n(\"0iUn\"),i=n(\"vYYK\"),r=n(\"RR9l\"),o=(n(\"q2A+\"),new function e(){Object(a.default)(this,e),Object(i.a)(this,\"translate\",function(e){return r[e]?r[e]:e})});t.a=o},\"8lYe\":function(e,t,n){\"use strict\";var a=n(\"q1tI\"),i=n.n(a),r=n(\"1oaW\");t.a=function(){return i.a.createElement(\"div\",{className:\"footer\",title:\"Footer\"},i.a.createElement(r.Footer,null,i.a.createElement(r.FooterLinks,null,i.a.createElement(r.FooterLink,{href:\"javascript:void(0);\"},\"ShowMine首页\")),i.a.createElement(r.FooterText,null,\"Copyright © 2018-2019 ShowMine\")),i.a.createElement(\"br\",null),i.a.createElement(\"br\",null))}},FN38:function(e,t){},LdrS:function(e,t,n){\"use strict\";var a=n(\"0iUn\"),i=n(\"vYYK\"),r=n(\"yHdQ\"),o=n(\"aZpa\"),l=new function e(){Object(a.default)(this,e),Object(i.a)(this,\"getItemDetail\",function(e){return r.a.get(o.a.webApi+\"item/\"+e)}),Object(i.a)(this,\"getRelatedProducts\",function(e){return r.a.get(o.a.webApi+\"item/company/\"+e)}),Object(i.a)(this,\"getCompanyJieLongList\",function(e,t){return r.a.get(o.a.webApi+\"item/company/\"+e+\"/jielong\",t)}),Object(i.a)(this,\"getCompanyConsultationList\",function(e,t){return r.a.get(o.a.webApi+\"item/company/\"+e+\"/consultation\",t)})};t.a=l},RNiq:function(e,t,n){\"use strict\";n.r(t);var a=n(\"ln6h\"),i=n.n(a),r=n(\"O40h\"),o=n(\"0iUn\"),l=n(\"sLSF\"),c=n(\"MI3g\"),s=n(\"a7VT\"),u=n(\"AT/M\"),d=n(\"Tit0\"),f=n(\"vYYK\"),p=n(\"q1tI\"),h=n.n(p),m=(n(\"p94v\"),n(\"1oaW\")),g=n(\"LdrS\"),v=n(\"sO60\"),b=n(\"kgcI\"),E=n(\"20a2\"),y=n.n(E),w=n(\"U869\"),O=(n(\"BUDJ\"),n(\"eDds\"),function(e){function t(e){var n;return Object(o.default)(this,t),(n=Object(c.default)(this,Object(s.default)(t).call(this,e))).state={demoIndex:0,image:n.props.image},n}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"componentWillReceiveProps\",value:function(e,t){this.setState({image:e.image,demoIndex:0})}},{key:\"render\",value:function(){var e=this;return h.a.createElement(\"div\",{style:j.swiperContainer},h.a.createElement(m.Swiper,{interval:2e3,auto:!0,height:350,onChange:function(t,n){return e.setState({demoIndex:n})}},this.state.image.map(function(e){return h.a.createElement(\"img\",{key:e.url,src:e.url,role:\"presentation\"})})))}}]),t}(h.a.Component)),j={swiperContainer:{border:\"1px solid #eee\",backgroundColor:\"#f8f8f8\"}},L=O,C=(n(\"tXcZ\"),n(\"FN38\"),n(\"YFqc\")),I=n.n(C),k=function(e){function t(e){var n;return Object(o.default)(this,t),(n=Object(c.default)(this,Object(s.default)(t).call(this,e))).state={product:n.props.product},n}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"render\",value:function(){var e=this.props.product;return h.a.createElement(I.a,{href:{pathname:\"/index\",query:{itemId:e.id}}},h.a.createElement(\"a\",null,h.a.createElement(\"img\",{style:N.img,src:e.images[0].url}),h.a.createElement(\"div\",{style:N.productTitle},e.title)))}}]),t}(p.Component),N={productTitle:{padding:\"5%\",overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",width:\"90%\",fontSize:\"12px\",color:\"#000\"},img:{width:\"100%\",height:\"30vw\",objectFit:\"cover\"}},J=k,S=function(e){function t(){return Object(o.default)(this,t),Object(c.default)(this,Object(s.default)(t).apply(this,arguments))}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"render\",value:function(){var e=this.props.productList?this.props.productList:void 0;return e?e.map(function(e,t){return h.a.createElement(\"div\",{key:e.id,style:_.productList},h.a.createElement(J,{product:e}))}):null}}]),t}(p.Component),_={productList:{boxShadow:\"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)\",width:\"45%\",display:\"inline-block\",margin:\"2vmin\"}},A=S,x=function(e){function t(e){return Object(o.default)(this,t),Object(c.default)(this,Object(s.default)(t).call(this,e))}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"render\",value:function(){var e=this.props.children?this.props.children:void 0;return e?e.map(function(e,t){return h.a.createElement(\"div\",{key:e.id,style:T.childContainer},h.a.createElement(\"div\",{style:T.childrenImg},e.images.map(function(e){return h.a.createElement(\"img\",{height:100,width:90,key:e.url,src:e.url})})),h.a.createElement(\"div\",{style:T.childrenContent},h.a.createElement(\"p\",null,e.title),h.a.createElement(\"p\",{style:T.childrenPrice},\"$\",e.price),h.a.createElement(\"span\",{style:T.childrenDesc},\"报名总数\",h.a.createElement(\"strong\",null,null!==e.participator_num?e.participator_num:0)),h.a.createElement(\"span\",{style:T.childrenDesc},\"已签到数\",h.a.createElement(\"strong\",null,e.fav_count),h.a.createElement(\"br\",null)),h.a.createElement(\"span\",{style:T.childrenDesc},\"取货地点\",h.a.createElement(\"br\",null),e.locations[0].title)))}):null}}]),t}(p.Component),T={childContainer:{display:\"flex\",backgroundColor:\"#fff\",flexDirection:\"row\",padding:\"5vmin\",marginTop:\"3vmin\"},childrenImg:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},childrenContent:{marginLeft:\"3vmin\"},childrenPrice:{color:\"#9f0000\"},childrenDesc:{fontSize:\"12px\",color:\"gray\"}},U=x,P=function(e){function t(e){var n;return Object(o.default)(this,t),n=Object(c.default)(this,Object(s.default)(t).call(this,e)),Object(f.a)(Object(u.default)(n),\"formatRawContent\",function(e){return e.replace(/<img([^>]*)\\ssrc=['\"]([^\"\\s]+)['\"]([^>]*)>/g,\"<img width=\\\"100%\\\" src='$2'/>\")}),n}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"render\",value:function(){var e=this.props.jieLongDetail?this.props.jieLongDetail:void 0,t=e&&e.description?this.formatRawContent(e.description):\"\";return e?h.a.createElement(\"div\",null,h.a.createElement(\"div\",{style:R.productInfo},h.a.createElement(\"div\",{style:R.dayCount}),h.a.createElement(\"div\",{style:R.visitTimes},\"访问次数\",h.a.createElement(\"br\",null),e.visit_times)),h.a.createElement(\"div\",{style:R.descriptionWrapper},h.a.createElement(\"h3\",null,e.title),h.a.createElement(\"div\",{style:R.descriptionBackground,dangerouslySetInnerHTML:{__html:t}}))):null}}]),t}(p.Component),R={productInfo:{fontSize:\"12px\",display:\"flex\",padding:\"2vmin\",flex:\"0.5\"},dayCount:{flex:1},visitTimes:{flex:1,textAlign:\"end\"},descriptionWrapper:{padding:\"2vmin\",paddingTop:0},descriptionBackground:{backgroundColor:\"#fff\"}},Y=P,D=n(\"8lYe\"),M=(n(\"1GYG\"),n(\"aZpa\")),q=function(e){function t(e){var n;return Object(o.default)(this,t),(n=Object(c.default)(this,Object(s.default)(t).call(this,e))).state={item:n.props.item,productList:void 0,showLoading:!1,userJieLongInfo:\"\",isLogin:!1,iosShow:!1,showVoucher:!1,actions:[{label:\"取消\",onClick:n.hide.bind(Object(u.default)(n))}]},n}return Object(d.default)(t,e),Object(l.default)(t,[{key:\"hide\",value:function(){this.setState({iosShow:!1})}},{key:\"componentDidMount\",value:function(){this.getIsInCurrentJieLong(),this.state.item.multi_participations&&this.getAllJielong(),this.getRelatedProducts(),this.setState({isLogin:localStorage.getItem(\"isLogIn\")})}},{key:\"componentWillReceiveProps\",value:function(e,t){this.setState({item:e.item})}},{key:\"getRelatedProducts\",value:function(){var e=this,t=this.state.item.company_id+\"?is_draft=0&is_sync_to_market=1&page=1&page-size=6\";g.a.getRelatedProducts(t).then(function(e){return e.json()}).then(function(t){e.setState({productList:t})}).catch(function(e){console.error(e)})}},{key:\"shouldComponentUpdate\",value:function(e){return this.state!==e}},{key:\"getIsInCurrentJieLong\",value:function(){var e=this,t=this.state.item.id;v.a.getIsInCurrentJieLong(t).then(function(e){return e.json()}).then(function(t){e.setState({userJieLongInfo:t})}).catch(function(e){console.error(e)})}},{key:\"getAllJielong\",value:function(){var e=this,t=this.state.item.id;localStorage.getItem(\"isLogIn\")&&v.a.getAllJielong(t).then(function(e){return e.json()}).then(function(t){e.setState({allJielongInfo:t})}).catch(function(e){console.error(e)})}},{key:\"cancelJielong\",value:function(){var e=this;this.hide(),this.setState({showLoading:!0});var t=this.state.userJieLongInfo.currentUserJieLong.id,n=\"https://www.showmine66.com/ma/i/\"+this.state.item.id;v.a.cancelJielong(t,n,{}).then(function(e){return e.json()}).then(function(t){e.setState({showLoading:!1}),window.location.reload()}).catch(function(e){console.error(e)})}},{key:\"updateJielong\",value:function(){var e={itemId:this.state.item.id,is_update:!0,jielongId:this.state.userJieLongInfo.currentUserJieLong.id};y.a.push({pathname:\"/checkoutPage\",query:e})}},{key:\"checkLoginStatus\",value:function(){var e={itemId:this.state.item.id};localStorage.getItem(\"isLogIn\")?y.a.push({pathname:\"/checkoutPage\",query:e}):this.weChatLogin()}},{key:\"weChatLogin\",value:function(){var e=this.state.item.id,t=M.a.webAddress+\"AuthPage\";b.a.wechatLogin(e,t,{}).then(function(e){return e.json()}).then(function(e){window.open(e.auth_url,\"_self\")}).catch(function(e){console.error(e),alert(e)})}},{key:\"render\",value:function(){var e=this,t=this.state.userJieLongInfo,n=this.state.productList&&this.state.productList.data?this.state.productList.data:void 0,a=this.state.item?this.state.item:void 0,i=this.state.allJielongInfo?this.state.allJielongInfo:void 0;return h.a.createElement(\"div\",{className:\"App\"},h.a.createElement(w.a,null),h.a.createElement(\"div\",{className:\"App-body\"},h.a.createElement(\"div\",{className:\"content\"},h.a.createElement(\"div\",{key:a.id},h.a.createElement(L,{image:a.images})),h.a.createElement(Y,{jieLongDetail:a||void 0})),this.state.isLogin&&t&&t.currentUserJieLong&&t.currentUserJieLong.voucher&&t.currentUserJieLong.voucher.refnum&&!a.multi_participations?h.a.createElement(m.Cells,null,h.a.createElement(m.Cell,{href:t.currentUserJieLong.voucher.img_url,access:!0},h.a.createElement(m.CellBody,null,h.a.createElement(\"div\",{className:\"isInJielong-row\"},h.a.createElement(\"div\",null,h.a.createElement(\"span\",{className:\"tag-icon\"},\"参加成功\"),\" 回执码：\",h.a.createElement(\"span\",{className:\"Ref-num\"},t.currentUserJieLong.voucher.refnum)))),h.a.createElement(m.CellFooter,null))):null,h.a.createElement(m.Cells,null,this.state.isLogin&&i?i.map(function(t){return h.a.createElement(\"div\",{key:t.id},h.a.createElement(m.Cell,{href:void 0,onClick:function(t){return e.setState({showVoucher:!0})},access:!0},h.a.createElement(m.CellBody,null,t&&t.is_paid&&t.voucher&&t.voucher.receipt&&t.voucher.receipt.amount&&t.voucher.refnum?h.a.createElement(\"div\",{className:\"allJielongInfo\"},h.a.createElement(\"div\",null,h.a.createElement(\"span\",{className:\"paidAmount-icon\"},\"已支付：$\",t.voucher.receipt.amount),\" 回执码：\",h.a.createElement(\"span\",{className:\"Ref-num\"},t.voucher.refnum))):h.a.createElement(\"div\",{className:\"isInJielong-row\"},t.voucher&&t.voucher.refnum?h.a.createElement(\"div\",null,h.a.createElement(\"span\",{className:\"tag-icon\"},\"参加成功\"),\" 回执码：\",h.a.createElement(\"span\",{className:\"Ref-num\"},t.voucher.refnum)):h.a.createElement(\"div\",null,\"提示：请在30分钟内完成支付，否则订单会撤销\"))),h.a.createElement(m.CellFooter,null)),h.a.createElement(m.Gallery,{src:t.voucher&&t.voucher.img_url?t.voucher.img_url:void 0,show:e.state.showVoucher},h.a.createElement(\"div\",{style:F.galleryButton,onClick:function(t){return e.setState({showVoucher:!1})}},\"Cancel\")))}):null),h.a.createElement(U,{children:a.children?a.children:void 0}),a.company?h.a.createElement(\"div\",null,h.a.createElement(\"div\",{className:\"company-info\"},h.a.createElement(\"div\",{className:\"company-img\"},h.a.createElement(\"img\",{height:100,src:a.company.logo_img.url,role:\"presentation\"})),h.a.createElement(\"div\",{className:\"company-content\"},h.a.createElement(\"div\",{className:\"company-title\"},a.company.name),h.a.createElement(\"div\",{className:\"company-followers\"},\"关注量：\",a.company.followers))),h.a.createElement(\"div\",{className:\"divider\"})):null,h.a.createElement(\"div\",{className:\"related-product\"},h.a.createElement(A,{productList:n})),h.a.createElement(D.a,null),h.a.createElement(\"div\",{className:\"button-area\"},this.state.isLogin&&t&&t.currentUserJieLong&&!t.currentUserJieLong.is_paid?h.a.createElement(\"div\",null,h.a.createElement(m.Button,{type:\"primary\",onClick:function(t){return e.setState({iosShow:!0})}},\"修改订单\"),h.a.createElement(m.ActionSheet,{menus:[{label:\"修改团购\",onClick:function(){e.updateJielong()}},{label:\"取消团购\",onClick:function(){e.cancelJielong()}}],actions:this.state.actions,show:this.state.iosShow,type:\"ios\",onRequestClose:function(t){return e.setState({iosShow:!1})},style:{color:\"black\"}}),h.a.createElement(m.Toast,{icon:\"loading\",show:this.state.showLoading},\"Loading...\")):h.a.createElement(m.Button,{type:\"primary\",className:\"button\",onClick:function(){e.checkLoginStatus()}},\"马上下单\"))))}}]),t}(p.Component);Object(f.a)(q,\"getInitialProps\",function(){var e=Object(r.default)(i.a.mark(function e(t){var n,a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.req,n=t.query,a=\"\",!n.itemId){e.next=8;break}return e.next=5,g.a.getItemDetail(n.itemId);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,g.a.getItemDetail(\"0f95b4d63b1afa75c3a9e2b3fae27cdf\");case 10:a=e.sent;case 11:return e.next=13,a.json();case 13:return r=e.sent,e.abrupt(\"return\",{item:r});case 15:case\"end\":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());var F={galleryButton:{color:\"white\",fontWeight:\"bold\",padding:\"0\"}};t.default=q},RR9l:function(e){e.exports={SHOWMINE:\"捎卖\",CONSULTATION:\"资讯文章\",\"COMPANY.FAVORITE\":\"收藏\",\"COMPANY.JIELONG.ONGOING\":\"正在抢\",\"COMPANY.JIELONG.PAST\":\"过往接龙\"}},U869:function(e,t,n){\"use strict\";var a=n(\"0iUn\"),i=n(\"sLSF\"),r=n(\"MI3g\"),o=n(\"a7VT\"),l=n(\"Tit0\"),c=n(\"q1tI\"),s=n.n(c),u=n(\"1GYG\"),d=n(\"tXcZ\"),f=(n(\"nOHt\"),function(e){function t(){return Object(a.default)(this,t),Object(r.default)(this,Object(o.default)(t).apply(this,arguments))}return Object(l.default)(t,e),Object(i.default)(t,[{key:\"render\",value:function(){return s.a.createElement(\"div\",null,s.a.createElement(d.a,null,s.a.createElement(\"meta\",{name:\"viewport\",content:\"initial-scale=1.0, width=device-width\"})),s.a.createElement(\"header\",{style:p.appHeader},u.a.translate(\"SHOWMINE\")))}}]),t}(s.a.Component)),p={appHeader:{backgroundColor:\"#efc929\",display:\"flex\",minHeight:\"15vmin\",flexDirection:\"row\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"20px\",fontWeight:\"bold\",color:\"black\"}};t.a=f},YFqc:function(e,t,n){e.exports=n(\"cTJO\")},cTJO:function(e,t,n){\"use strict\";var a=n(\"KI45\"),i=a(n(\"9Jkg\")),r=a(n(\"iZP3\")),o=a(n(\"/HRN\")),l=a(n(\"WaGi\")),c=a(n(\"ZDA2\")),s=a(n(\"/+P4\")),u=a(n(\"N9n2\")),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},f=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var p=n(\"CxY0\"),h=d(n(\"q1tI\")),m=(f(n(\"17x9\")),d(n(\"20a2\"))),g=n(\"Bu4q\");var v=function(e){function t(){var e,n,a,i,l;return(0,o.default)(this,t),(e=(0,c.default)(this,(0,s.default)(t).apply(this,arguments))).formatUrls=(n=function(e,t){return{href:e&&\"object\"===(0,r.default)(e)?g.formatWithValidation(e):e,as:t&&\"object\"===(0,r.default)(t)?g.formatWithValidation(t):t}},a=null,i=null,l=null,function(e,t){if(e===a&&t===i)return l;var r=n(e,t);return a=e,i=t,l=r,r}),e.linkClicked=function(t){var n=t.currentTarget,a=n.nodeName,i=n.target;if(\"A\"!==a||!(i&&\"_self\"!==i||t.metaKey||t.ctrlKey||t.shiftKey||t.nativeEvent&&2===t.nativeEvent.which)){var r=e.formatUrls(e.props.href,e.props.as),o=r.href,l=r.as;if(function(e){var t=p.parse(e,!1,!0),n=p.parse(g.getLocationOrigin(),!1,!0);return!t.host||t.protocol===n.protocol&&t.host===n.host}(o)){var c=window.location.pathname;o=p.resolve(c,o),l=l?p.resolve(c,l):o,t.preventDefault();var s=e.props.scroll;null==s&&(s=l.indexOf(\"#\")<0),m.default[e.props.replace?\"replace\":\"push\"](o,l,{shallow:e.props.shallow}).then(function(e){e&&s&&(window.scrollTo(0,0),document.body.focus())}).catch(function(t){e.props.onError&&e.props.onError(t)})}}},e}return(0,u.default)(t,e),(0,l.default)(t,[{key:\"componentDidMount\",value:function(){this.prefetch()}},{key:\"componentDidUpdate\",value:function(e){(0,i.default)(this.props.href)!==(0,i.default)(e.href)&&this.prefetch()}},{key:\"prefetch\",value:function(){if(this.props.prefetch&&\"undefined\"!=typeof window){var e=window.location.pathname,t=this.formatUrls(this.props.href,this.props.as).href,n=p.resolve(e,t);m.default.prefetch(n)}}},{key:\"render\",value:function(){var e=this,t=this.props.children,n=this.formatUrls(this.props.href,this.props.as),a=n.href,i=n.as;\"string\"==typeof t&&(t=h.default.createElement(\"a\",null,t));var r=h.Children.only(t),o={onClick:function(t){r.props&&\"function\"==typeof r.props.onClick&&r.props.onClick(t),t.defaultPrevented||e.linkClicked(t)}};return!this.props.passHref&&(\"a\"!==r.type||\"href\"in r.props)||(o.href=i||a),o.href&&\"undefined\"!=typeof __NEXT_DATA__&&__NEXT_DATA__.nextExport&&(o.href=m.Router._rewriteUrlForNextExport(o.href)),h.default.cloneElement(r,o)}}]),t}(h.Component);t.default=v},kgcI:function(e,t,n){\"use strict\";var a=n(\"0iUn\"),i=n(\"vYYK\"),r=n(\"yHdQ\"),o=n(\"aZpa\"),l=new function e(){Object(a.default)(this,e),Object(i.a)(this,\"login\",function(e){return r.a.post(o.a.webApi+\"login\",e)}),Object(i.a)(this,\"register\",function(e){return r.a.post(o.a.webApi+\"register\",e)}),Object(i.a)(this,\"wechatLogin\",function(e,t,n){return r.a.get2(o.a.webApi+\"/wechat/authUrl?apiUrl=https://api.showmine66.com&origUrl=\"+e+\"&authUrl=\"+t,n)})};t.a=l},\"q2A+\":function(e){e.exports={SHOWMINE:\"ShowMine\",CONSULTATION:\"Consultation\",\"COMPANY.FAVORITE\":\"Subscribers\",\"COMPANY.JIELONG.ONGOING\":\"Ongoing JieLong\",\"COMPANY.JIELONG.PAST\":\"Previous JieLong\"}},sO60:function(e,t,n){\"use strict\";var a=n(\"0iUn\"),i=n(\"vYYK\"),r=n(\"yHdQ\"),o=n(\"aZpa\"),l=new function e(){Object(a.default)(this,e),Object(i.a)(this,\"addJielong\",function(e,t){return r.a.post(o.a.webApi+\"jielong/\"+t+\"/subitems\",e)}),Object(i.a)(this,\"generateVoucher\",function(e,t){return r.a.post(o.a.webApi+\"jielong/voucher/\"+t,e)}),Object(i.a)(this,\"getIsInCurrentJieLong\",function(e){return r.a.get2(o.a.webApi+\"jielong/isInJielong/\"+e)}),Object(i.a)(this,\"cancelJielong\",function(e,t,n){return r.a.delete(o.a.webApi+\"comment/\"+e+\"?item_url=\"+t,n)}),Object(i.a)(this,\"updateJielong\",function(e,t){return r.a.put(o.a.webApi+\"jielong/\"+t+\"/subitems\",e)}),Object(i.a)(this,\"getAllJielong\",function(e){return r.a.get2(o.a.webApi+\"jielong/getAllJielong/\"+e)})};t.a=l},vlRD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){var e=n(\"RNiq\");return{page:e.default||e}}])}},[[\"vlRD\",0,1,2]]]);","extractedComments":[]}