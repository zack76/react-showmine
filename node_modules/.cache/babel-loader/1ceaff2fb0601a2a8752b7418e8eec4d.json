{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/Zac/Sysbox/SHM_React/shm-react/my-app/pages/index.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport { Button, Cells, Cell, CellBody, CellFooter, ActionSheet, Toast } from 'react-weui';\nimport DetailService from '../service/DetailService';\nimport JielongService from '../service/JielongService';\nimport AuthService from \"../service/AuthService\";\nimport Router from 'next/router'; //import styles\n\nimport 'weui';\nimport 'react-weui/build/packages/react-weui.css'; //import component\n\nimport Swipe from '../components/Swipe';\nimport Head from \"../components/head\";\nimport ProductCardGrid from \"../components/ProductCards/ProductCardGrid\";\nimport ChildrenList from '../components/JieLong/ChildrenList';\nimport JielongContent from '../components/JieLong/JieLongContent';\nimport Footer from \"../components/Footer\";\nimport Lang from '../lang/Lang';\nimport { Config } from \"../Config\";\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      item: _this.props.item,\n      productList: undefined,\n      showLoading: false,\n      userJieLongInfo: '',\n      isLogin: false,\n      iosShow: false,\n      actions: [{\n        label: '取消',\n        onClick: _this.hide.bind(_assertThisInitialized(_this))\n      }]\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"hide\",\n    value: function hide() {\n      this.setState({\n        iosShow: false\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getIsInCurrentJieLong();\n\n      if (this.state.item.multi_participations) {\n        this.getAllJielong();\n      }\n\n      this.getRelatedProducts();\n      this.setState({\n        isLogin: localStorage.getItem('isLogIn')\n      });\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(object, nextProps) {\n      this.setState({\n        item: object.item\n      });\n    }\n  }, {\n    key: \"getRelatedProducts\",\n    value: function getRelatedProducts() {\n      var _this2 = this;\n\n      var params = this.state.item.company_id + '?is_draft=0&is_sync_to_market=1&page=1&page-size=6';\n      DetailService.getRelatedProducts(params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this2.setState({\n          productList: responseJson\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      return this.state !== nextProps;\n    }\n  }, {\n    key: \"getIsInCurrentJieLong\",\n    value: function getIsInCurrentJieLong() {\n      var _this3 = this;\n\n      localStorage.setItem('userToken', '3fcb34cf22187d53c127a9b02b4f1184');\n      localStorage.setItem('isLogIn', true);\n      var id = this.state.item.id;\n      JielongService.getIsInCurrentJieLong(id).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this3.setState({\n          userJieLongInfo: responseJson\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"getAllJielong\",\n    value: function getAllJielong() {\n      var _this4 = this;\n\n      var id = this.state.item.id;\n      var userToken = localStorage.getItem('userToken');\n\n      if (userToken) {\n        JielongService.getAllJielong(id).then(function (response) {\n          return response.json();\n        }).then(function (responseJson) {\n          _this4.setState({\n            allJielongInfo: responseJson\n          });\n        }).catch(function (error) {\n          console.error(error);\n        });\n      }\n    }\n  }, {\n    key: \"cancelJielong\",\n    value: function cancelJielong() {\n      var _this5 = this;\n\n      this.hide();\n      this.setState({\n        showLoading: true\n      });\n      var id = this.state.userJieLongInfo.currentUserJieLong.id;\n      var url = \"https://www.showmine66.com/ma/i/\" + this.state.item.id;\n      var params = {};\n      JielongService.cancelJielong(id, url, params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this5.setState({\n          showLoading: false\n        });\n\n        window.location.reload();\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"updateJielong\",\n    value: function updateJielong() {\n      var itemId = {\n        itemId: this.state.item.id,\n        is_update: true,\n        jielongId: this.state.userJieLongInfo.currentUserJieLong.id\n      };\n      Router.push({\n        pathname: '/checkoutPage',\n        query: itemId\n      });\n    }\n  }, {\n    key: \"checkLoginStatus\",\n    value: function checkLoginStatus() {\n      var itemId = {\n        itemId: this.state.item.id\n      };\n      var login = localStorage.getItem('isLogIn');\n\n      if (login) {\n        Router.push({\n          pathname: '/checkoutPage',\n          query: itemId\n        });\n      } else {\n        this.weChatLogin();\n      }\n    }\n  }, {\n    key: \"weChatLogin\",\n    value: function weChatLogin() {\n      var origUrl = this.state.item.id; // let authUrl = \"http://localhost:3000/AuthPage\";\n\n      var authUrl = Config.webAddress + \"AuthPage\";\n      var params = {};\n      AuthService.wechatLogin(origUrl, authUrl, params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        window.open(responseJson.auth_url, \"_self\");\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"showVoucher\",\n    value: function showVoucher() {\n      console.log('yes');\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var userJieLongInfo = this.state.userJieLongInfo;\n      var productList = this.state.productList && this.state.productList.data ? this.state.productList.data : undefined;\n      var item = this.state.item ? this.state.item : undefined;\n      var allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(Head, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"meta\", {\n        name: \"viewport\",\n        content: \"initial-scale=1.0, width=device-width\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      })), React.createElement(\"header\", {\n        className: \"App-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        onClick: function onClick() {\n          return Router.push('/loginPage');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, Lang.translate('SHOWMINE'))), React.createElement(\"div\", {\n        className: \"App-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }, this.state.isLogin && allJielongInfo ? allJielongInfo.map(function (jieLong) {\n        return React.createElement(Cell, {\n          key: jieLong.id,\n          href: undefined,\n          onClick: _this6.showVoucher,\n          access: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, React.createElement(CellBody, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }, jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          className: \"allJielongInfo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"paidAmount-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, \"\\u5DF2\\u652F\\u4ED8\\uFF1A$\", jieLong.voucher.receipt.amount), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, jieLong.voucher.refnum))) : React.createElement(\"div\", {\n          className: \"isInJielong-row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }, jieLong.voucher && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"tag-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226\n          },\n          __self: this\n        }, jieLong.voucher.refnum)) : React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228\n          },\n          __self: this\n        }, \"\\u63D0\\u793A\\uFF1A\\u8BF7\\u572830\\u5206\\u949F\\u5185\\u5B8C\\u6210\\u652F\\u4ED8\\uFF0C\\u5426\\u5219\\u8BA2\\u5355\\u4F1A\\u64A4\\u9500\"))), React.createElement(CellFooter, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 233\n          },\n          __self: this\n        }));\n      }) : null), React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        key: item.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(Swipe, {\n        image: item.images,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      })), React.createElement(JielongContent, {\n        jieLongDetail: item ? item : undefined,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      })), this.state.isLogin && userJieLongInfo && userJieLongInfo.currentUserJieLong && userJieLongInfo.currentUserJieLong.voucher && userJieLongInfo.currentUserJieLong.voucher.refnum && !item.multi_participations ? React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(Cell, {\n        href: userJieLongInfo.currentUserJieLong.voucher.img_url,\n        access: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"isInJielong-row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"tag-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n        className: \"Ref-num\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, userJieLongInfo.currentUserJieLong.voucher.refnum)))), React.createElement(CellFooter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }))) : null, React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }, this.state.isLogin && allJielongInfo ? allJielongInfo.map(function (jieLong) {\n        return React.createElement(Cell, {\n          key: jieLong.id,\n          href: jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined,\n          access: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 266\n          },\n          __self: this\n        }, React.createElement(CellBody, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 267\n          },\n          __self: this\n        }, jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          className: \"allJielongInfo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"paidAmount-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        }, \"\\u5DF2\\u652F\\u4ED8\\uFF1A$\", jieLong.voucher.receipt.amount), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271\n          },\n          __self: this\n        }, jieLong.voucher.refnum))) : React.createElement(\"div\", {\n          className: \"isInJielong-row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 274\n          },\n          __self: this\n        }, jieLong.voucher && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"tag-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277\n          },\n          __self: this\n        }, jieLong.voucher.refnum)) : React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 279\n          },\n          __self: this\n        }, \"\\u63D0\\u793A\\uFF1A\\u8BF7\\u572830\\u5206\\u949F\\u5185\\u5B8C\\u6210\\u652F\\u4ED8\\uFF0C\\u5426\\u5219\\u8BA2\\u5355\\u4F1A\\u64A4\\u9500\"))), React.createElement(CellFooter, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 284\n          },\n          __self: this\n        }));\n      }) : null), React.createElement(ChildrenList, {\n        children: item.children ? item.children : undefined,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }), item.company ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"company-info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"company-img\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        height: 100,\n        src: item.company.logo_img.url,\n        role: \"presentation\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"company-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"company-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }, item.company.name), React.createElement(\"div\", {\n        className: \"company-followers\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }, \"\\u5173\\u6CE8\\u91CF\\uFF1A\", item.company.followers))), React.createElement(\"div\", {\n        className: \"divider\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      })) : null, React.createElement(\"div\", {\n        className: \"related-product\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      }, React.createElement(ProductCardGrid, {\n        productList: productList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311\n        },\n        __self: this\n      })), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"button-area\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, this.state.isLogin && userJieLongInfo && userJieLongInfo.currentUserJieLong && !userJieLongInfo.currentUserJieLong.is_paid ? React.createElement(\"div\", {\n        style: {\n          color: 'black'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, React.createElement(Button, {\n        type: \"primary\",\n        onClick: function onClick(e) {\n          return _this6.setState({\n            iosShow: true\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, \"\\u4FEE\\u6539\\u8BA2\\u5355\"), React.createElement(ActionSheet, {\n        menus: [{\n          label: '修改团购',\n          onClick: function onClick() {\n            _this6.updateJielong();\n          }\n        }, {\n          label: '取消团购',\n          onClick: function onClick() {\n            _this6.cancelJielong();\n          }\n        }],\n        actions: this.state.actions,\n        show: this.state.iosShow,\n        type: \"ios\",\n        onRequestClose: function onRequestClose(e) {\n          return _this6.setState({\n            iosShow: false\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }), React.createElement(Toast, {\n        icon: \"loading\",\n        show: this.state.showLoading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, \"Loading...\")) : React.createElement(Button, {\n        type: \"primary\",\n        className: \"button\",\n        onClick: function onClick() {\n          _this6.checkLoginStatus();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, \"\\u9A6C\\u4E0A\\u4E0B\\u5355\"))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\n_defineProperty(App, \"getInitialProps\",\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref) {\n    var req, query, res, json;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            req = _ref.req, query = _ref.query;\n            res = '';\n\n            if (!query.itemId) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 5;\n            return DetailService.getDetail(query.itemId);\n\n          case 5:\n            res = _context.sent;\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.next = 10;\n            return DetailService.getDetail('0f95b4d63b1afa75c3a9e2b3fae27cdf');\n\n          case 10:\n            res = _context.sent;\n\n          case 11:\n            _context.next = 13;\n            return res.json();\n\n          case 13:\n            json = _context.sent;\n            return _context.abrupt(\"return\", {\n              item: json\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}());\n\nexport default App;","map":{"version":3,"sources":["/Users/Zac/Sysbox/SHM_React/shm-react/my-app/pages/index.js"],"names":["React","Component","Button","Cells","Cell","CellBody","CellFooter","ActionSheet","Toast","DetailService","JielongService","AuthService","Router","Swipe","Head","ProductCardGrid","ChildrenList","JielongContent","Footer","Lang","Config","App","props","state","item","productList","undefined","showLoading","userJieLongInfo","isLogin","iosShow","actions","label","onClick","hide","bind","setState","getIsInCurrentJieLong","multi_participations","getAllJielong","getRelatedProducts","localStorage","getItem","object","nextProps","params","company_id","then","response","json","responseJson","catch","error","console","setItem","id","userToken","allJielongInfo","currentUserJieLong","url","cancelJielong","window","location","reload","itemId","is_update","jielongId","push","pathname","query","login","weChatLogin","origUrl","authUrl","webAddress","wechatLogin","open","auth_url","log","data","translate","map","jieLong","showVoucher","is_paid","voucher","receipt","amount","refnum","images","img_url","children","company","logo_img","name","followers","color","e","updateJielong","checkLoginStatus","req","res","getDetail"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport {Button, Cells, Cell, CellBody, CellFooter, ActionSheet, Toast} from 'react-weui';\nimport DetailService from '../service/DetailService';\nimport JielongService from '../service/JielongService';\nimport AuthService from \"../service/AuthService\";\nimport Router from 'next/router';\n\n\n\n//import styles\nimport 'weui';\nimport 'react-weui/build/packages/react-weui.css';\n\n\n//import component\nimport Swipe from '../components/Swipe'\nimport Head from \"../components/head\";\nimport ProductCardGrid from \"../components/ProductCards/ProductCardGrid\";\nimport ChildrenList from '../components/JieLong/ChildrenList';\nimport JielongContent from '../components/JieLong/JieLongContent';\nimport Footer from \"../components/Footer\";\nimport Lang from '../lang/Lang';\nimport {Config} from \"../Config\";\n\n\n\nclass App extends Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            item: this.props.item,\n            productList: undefined,\n            showLoading: false,\n            userJieLongInfo: '',\n            isLogin: false,\n            iosShow: false,\n            actions: [\n                {\n                    label: '取消',\n                    onClick: this.hide.bind(this)\n                }\n            ],\n        };\n    }\n\n    hide(){\n        this.setState({\n            iosShow: false,\n        });\n    }\n\n    static getInitialProps = async({ req, query }) => {\n        let res = '';\n        if (query.itemId) {\n            res = await DetailService.getDetail(query.itemId);\n        }\n        else {\n            // res = await DetailService.getDetail('a3067bcbd7521b4965ef8b43394aa011');\n            res = await DetailService.getDetail('0f95b4d63b1afa75c3a9e2b3fae27cdf');\n        }\n        const json = await res.json();\n        return { item: json };\n    };\n\n\n    componentDidMount() {\n        this.getIsInCurrentJieLong();\n        if (this.state.item.multi_participations) {\n            this.getAllJielong();\n        }\n        this.getRelatedProducts();\n        this.setState({\n            isLogin: localStorage.getItem('isLogIn'),\n        });\n    }\n\n    componentWillReceiveProps(object, nextProps) {\n        this.setState({\n            item: object.item\n        })\n    }\n\n    getRelatedProducts() {\n        let params = this.state.item.company_id + '?is_draft=0&is_sync_to_market=1&page=1&page-size=6';\n        DetailService.getRelatedProducts(params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({\n                    productList: responseJson\n                });\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    shouldComponentUpdate(nextProps) {\n        return this.state !== nextProps;\n    }\n\n    getIsInCurrentJieLong() {\n        localStorage.setItem('userToken', '3fcb34cf22187d53c127a9b02b4f1184');\n        localStorage.setItem('isLogIn', true);\n\n        let id = this.state.item.id;\n        JielongService.getIsInCurrentJieLong(id)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({\n                    userJieLongInfo: responseJson,\n                });\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    getAllJielong() {\n        let id = this.state.item.id;\n        const userToken = localStorage.getItem('userToken');\n        if (userToken) {\n            JielongService.getAllJielong(id)\n                .then((response) => response.json())\n                .then((responseJson) => {\n                    this.setState({\n                        allJielongInfo: responseJson,\n                    });\n                })\n                .catch((error) => {\n                    console.error(error);\n                });\n        }\n\n    }\n\n    cancelJielong() {\n        this.hide();\n        this.setState({showLoading: true});\n        let id = this.state.userJieLongInfo.currentUserJieLong.id;\n        let url = \"https://www.showmine66.com/ma/i/\" + this.state.item.id;\n        let params ={};\n        JielongService.cancelJielong(id, url, params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({showLoading: false});\n                window.location.reload();\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    updateJielong() {\n        let itemId = { itemId: this.state.item.id, is_update: true, jielongId: this.state.userJieLongInfo.currentUserJieLong.id};\n        Router.push({\n            pathname: '/checkoutPage',\n            query: itemId,\n        });\n    }\n\n    checkLoginStatus() {\n        let itemId = { itemId: this.state.item.id};\n        let login = localStorage.getItem('isLogIn');\n        if (login) {\n            Router.push({\n                pathname: '/checkoutPage',\n                query: itemId,\n            });\n        }\n        else {\n            this.weChatLogin();\n        }\n    }\n\n    weChatLogin() {\n        let origUrl = this.state.item.id;\n        // let authUrl = \"http://localhost:3000/AuthPage\";\n        let authUrl = Config.webAddress + \"AuthPage\";\n        let params ={};\n        AuthService.wechatLogin(origUrl, authUrl, params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                window.open(responseJson.auth_url, \"_self\");\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    showVoucher() {\n        console.log('yes');\n    }\n\n    render() {\n        const userJieLongInfo = this.state.userJieLongInfo;\n        const productList = this.state.productList && this.state.productList.data ? this.state.productList.data : undefined;\n        const item = this.state.item ? this.state.item : undefined;\n        const allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n        return (\n            <div className=\"App\">\n                <Head>\n                    <meta name=\"viewport\" content=\"initial-scale=1.0, width=device-width\" />\n                </Head>\n                <header className=\"App-header\">\n                    <div onClick={() => Router.push('/loginPage')}>\n                        {Lang.translate('SHOWMINE')}\n                    </div>\n                </header>\n                <div className='App-body'>\n                    <Cells>\n                        {\n                            this.state.isLogin && allJielongInfo ?\n                                allJielongInfo.map((jieLong) =>\n                                    <Cell key={jieLong.id} href={undefined} onClick={this.showVoucher} access>\n                                        <CellBody>\n                                            {\n                                                jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ?\n                                                    <div className='allJielongInfo'>\n                                                        <div><span className='paidAmount-icon'>已支付：${jieLong.voucher.receipt.amount}</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                    </div>\n                                                    :\n                                                    <div className='isInJielong-row'>\n                                                        {\n                                                            jieLong.voucher && jieLong.voucher.refnum ?\n                                                                <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                                :\n                                                                <div>提示：请在30分钟内完成支付，否则订单会撤销</div>\n                                                        }\n                                                    </div>\n                                            }\n                                        </CellBody>\n                                        <CellFooter/>\n                                    </Cell>\n                                )\n                                :\n                                null\n                        }\n                    </Cells>\n                    <div className='content'>\n                        <div key={item.id}>\n                            <Swipe image={item.images}/>\n                        </div>\n                        <JielongContent jieLongDetail={item ? item : undefined}/>\n                    </div>\n                    {\n                        this.state.isLogin && userJieLongInfo && userJieLongInfo.currentUserJieLong && userJieLongInfo.currentUserJieLong.voucher && userJieLongInfo.currentUserJieLong.voucher.refnum && !item.multi_participations ?\n                            (\n                                <Cells>\n                                    <Cell href={userJieLongInfo.currentUserJieLong.voucher.img_url} access>\n                                        <CellBody>\n                                            <div className='isInJielong-row'>\n                                                <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{userJieLongInfo.currentUserJieLong.voucher.refnum}</span></div>\n                                            </div>\n                                        </CellBody>\n                                        <CellFooter/>\n                                    </Cell>\n                                </Cells>\n                            )\n                            : null\n                    }\n                    <Cells>\n                        {\n                            this.state.isLogin && allJielongInfo ?\n                                allJielongInfo.map((jieLong) =>\n                                    <Cell key={jieLong.id} href={jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined} access>\n                                        <CellBody>\n                                            {\n                                                jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ?\n                                                    <div className='allJielongInfo'>\n                                                        <div><span className='paidAmount-icon'>已支付：${jieLong.voucher.receipt.amount}</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                    </div>\n                                                    :\n                                                    <div className='isInJielong-row'>\n                                                        {\n                                                            jieLong.voucher && jieLong.voucher.refnum ?\n                                                                <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                                :\n                                                                <div>提示：请在30分钟内完成支付，否则订单会撤销</div>\n                                                        }\n                                                    </div>\n                                            }\n                                        </CellBody>\n                                        <CellFooter/>\n                                    </Cell>\n                                )\n                                :\n                                null\n                        }\n                    </Cells>\n                    <ChildrenList children={item.children ? item.children : undefined}/>\n                    {item.company ?\n                        (\n                            <div>\n                                <div className='company-info'>\n                                    <div className='company-img'>\n                                        <img height={100} src={item.company.logo_img.url} role=\"presentation\" />\n                                    </div>\n                                    <div className='company-content'>\n                                        <div className='company-title'>{item.company.name}</div>\n                                        <div className='company-followers'>关注量：{item.company.followers}</div>\n                                    </div>\n                                </div>\n                                <div className='divider'/>\n                            </div>)\n                        :\n                        null\n                    }\n\n                    <div className='related-product'>\n                        <ProductCardGrid productList={productList}/>\n                    </div>\n                    <Footer/>\n                    <div className='button-area'>\n                        {this.state.isLogin && userJieLongInfo && userJieLongInfo.currentUserJieLong && !userJieLongInfo.currentUserJieLong.is_paid ?\n                            (\n                                <div style={{color:'black'}}>\n                                    <Button type=\"primary\" onClick={e=>this.setState({iosShow: true})}>修改订单</Button>\n                                    <ActionSheet\n                                        menus={[{\n                                            label: '修改团购',\n                                            onClick: ()=> {this.updateJielong();}\n                                        }, {\n                                            label: '取消团购',\n                                            onClick: ()=> {this.cancelJielong();}\n                                        }]}\n                                        actions={this.state.actions}\n                                        show={this.state.iosShow}\n                                        type=\"ios\"\n                                        onRequestClose={e=>this.setState({iosShow: false})}\n                                    />\n                                    <Toast icon=\"loading\" show={this.state.showLoading}>Loading...</Toast>\n                                </div>\n                            )\n                            :\n                            <Button type=\"primary\" className='button' onClick={()=>{this.checkLoginStatus();}}>马上下单</Button>\n                        }\n                    </div>\n                </div>\n            </div>\n\n        );\n    }\n}\n\nexport default App;\n\n\n\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}