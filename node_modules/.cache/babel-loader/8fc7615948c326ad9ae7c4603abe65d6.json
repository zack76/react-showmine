{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/Cart/CheckoutView.js\";\nimport React from 'react';\nimport Colors from \"../../constants/Colors\";\nimport { Button, TextArea, ActionSheet, Switch, Radio, Cells, CellsTitle, Cell, CellHeader, CellBody, CellFooter, Form, FormCell, Input, Label, LoadMore, Toast } from 'react-weui';\nimport CheckoutItemList from \"./CheckoutItemList\";\nimport PaymentService from '../../service/PaymentService';\nimport Lang from \"../../lang/Lang\";\nimport CartService from \"../../service/CartService\";\n\nvar CheckoutView =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CheckoutView, _React$Component);\n\n  function CheckoutView(props) {\n    var _this;\n\n    _classCallCheck(this, CheckoutView);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CheckoutView).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getCompanyPickupLocations\", function () {\n      var tmpLocations = false;\n\n      if (_this.state.company.pickup_locations && _this.state.company.pickup_locations.length > 0) {\n        _this.setState({\n          pickupLocationList: _this.state.company.pickup_locations\n        });\n      } else {\n        _this.setState({\n          pickupLocationList: tmpLocations\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleInputFieldChange\", function (event) {\n      var params = _this.state.params;\n      params[event.target.name] = event.target.value;\n\n      _this.setState({\n        params: params\n      }, function () {\n        console.log(_this.state);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showHideLocationMenu\", function () {\n      _this.setState(function (prevState) {\n        return {\n          showLocationPopup: !prevState.showLocationPopup\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updatePickupLocation\", function (location) {\n      var params = _this.state.params;\n      params.location = location;\n\n      _this.setState({\n        params: params\n      }, function () {\n        _this.showHideLocationMenu();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"createOrder\", function () {\n      PaymentService.createOrder(params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this.setState({\n          cartItems: cartItems,\n          selectedItemList: cartItems\n        }, function () {\n          _this.CalculateTotalCost(cartItems);\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    });\n\n    _this.state = {\n      parentItem: _this.props.parentItem,\n      selectedList: _this.props.selectedList,\n      company: _this.props.parentItem.company ? _this.props.parentItem.company : undefined,\n      params: {\n        name: '',\n        contactNum: '',\n        notes: '',\n        address: '',\n        location: {}\n      }\n    };\n    return _this;\n  }\n\n  _createClass(CheckoutView, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps, nextContext) {\n      this.setState({\n        selectedList: nextProps.selectedList\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getCompanyPickupLocations();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var selectedList = this.state.selectedList;\n      console.log(selectedList);\n      var pickupLocationList = this.state.pickupLocationList;\n      var locationMenu = undefined;\n\n      if (pickupLocationList) {\n        locationMenu = pickupLocationList.map(function (location) {\n          return React.createElement(ActionSheet, {\n            key: location.id,\n            menus: [{\n              label: location.title,\n              onClick: function onClick() {\n                _this2.updatePickupLocation(location);\n              }\n            }],\n            actions: [{\n              label: '关闭',\n              onClick: function onClick() {\n                return _this2.showHideLocationMenu();\n              }\n            }],\n            show: _this2.state.showLocationPopup,\n            type: \"ios\",\n            onRequestClose: function onRequestClose() {\n              return _this2.showHideLocationMenu();\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 97\n            },\n            __self: this\n          });\n        });\n      }\n\n      return React.createElement(\"div\", {\n        style: styles.viewWrapper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(CellsTitle, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, \"\\u53D6\\u8D27\\u5730\\u70B9*\"), React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(Cell, {\n        access: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, React.createElement(CellBody, {\n        onClick: function onClick() {\n          _this2.showHideLocationMenu();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, this.state.params.location.id ? this.state.params.location.title : React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"\\u8BF7\\u9009\\u62E9\\u53D6\\u8D27\\u5730\\u70B9\")), React.createElement(CellFooter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }))), React.createElement(CellsTitle, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"\\u8054\\u7CFB\\u65B9\\u5F0F*\"), React.createElement(Form, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(FormCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(CellHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"\\u59D3\\u540D\")), React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(Input, {\n        type: \"text\",\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u59D3\\u540D\",\n        name: \"name\",\n        value: this.state.contactName,\n        onChange: this.handleInputFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }))), React.createElement(FormCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, React.createElement(CellHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, \"\\u8054\\u7CFB\\u7535\\u8BDD\")), React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(Input, {\n        type: \"number\",\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7\",\n        name: \"contactNum\",\n        value: this.state.contactNum,\n        onChange: this.handleInputFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }))), React.createElement(FormCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(CellHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(Label, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"\\u5730\\u5740\")), React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(Input, {\n        type: \"text\",\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u5730\\u5740\",\n        name: \"address\",\n        value: this.state.contactAddress,\n        onChange: this.handleInputFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      })))), React.createElement(CellsTitle, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \"\\u5907\\u6CE8\"), React.createElement(Form, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(FormCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(TextArea, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u6587\\u672C\",\n        rows: \"3\",\n        name: \"notes\",\n        value: this.state.notes,\n        onChange: this.handleInputFieldChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      })))), React.createElement(CellsTitle, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"\\u5171\", selectedList.length, \"\\u4EF6\\u5546\\u54C1\"), React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(CheckoutItemList, {\n        children: selectedList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: styles.buttonGroupContainer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(Button, {\n        type: \"primary\",\n        onClick: function onClick() {\n          _this2.checkLoginStatus();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"\\u786E\\u8BA4\\u8BA2\\u5355\")), locationMenu);\n    }\n  }]);\n\n  return CheckoutView;\n}(React.Component);\n\nvar styles = {\n  viewWrapper: {\n    backgroundColor: Colors.formBackground,\n    paddingTop: '1vw'\n  },\n  buttonGroupContainer: {\n    position: 'fixed',\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    backgroundColor: '#fff',\n    color: '#fff',\n    textAlign: 'center'\n  }\n};\nexport default CheckoutView;","map":{"version":3,"sources":["/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/Cart/CheckoutView.js"],"names":["React","Colors","Button","TextArea","ActionSheet","Switch","Radio","Cells","CellsTitle","Cell","CellHeader","CellBody","CellFooter","Form","FormCell","Input","Label","LoadMore","Toast","CheckoutItemList","PaymentService","Lang","CartService","CheckoutView","props","tmpLocations","state","company","pickup_locations","length","setState","pickupLocationList","event","params","target","name","value","console","log","prevState","showLocationPopup","location","showHideLocationMenu","createOrder","then","response","json","responseJson","cartItems","selectedItemList","CalculateTotalCost","catch","error","parentItem","selectedList","undefined","contactNum","notes","address","nextProps","nextContext","getCompanyPickupLocations","locationMenu","map","id","label","title","onClick","updatePickupLocation","styles","viewWrapper","contactName","handleInputFieldChange","contactAddress","buttonGroupContainer","checkLoginStatus","Component","backgroundColor","formBackground","paddingTop","position","left","bottom","width","color","textAlign"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Colors from \"../../constants/Colors\";\nimport {Button, TextArea, ActionSheet, Switch, Radio, Cells, CellsTitle, Cell, CellHeader, CellBody, CellFooter, Form, FormCell, Input, Label, LoadMore, Toast,} from 'react-weui';\nimport CheckoutItemList from \"./CheckoutItemList\";\nimport PaymentService from '../../service/PaymentService';\nimport Lang from \"../../lang/Lang\";\nimport CartService from \"../../service/CartService\";\n\n\nclass CheckoutView extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            parentItem: this.props.parentItem,\n            selectedList: this.props.selectedList,\n            company: this.props.parentItem.company ? this.props.parentItem.company : undefined,\n            params: {\n                name: '',\n                contactNum: '',\n                notes: '',\n                address: '',\n                location: {}\n            },\n        };\n    }\n\n    componentWillReceiveProps(nextProps, nextContext) {\n        this.setState({\n            selectedList: nextProps.selectedList\n        })\n    }\n    componentDidMount() {\n        this.getCompanyPickupLocations();\n    }\n\n    getCompanyPickupLocations = () => {\n        let tmpLocations = false;\n        if (this.state.company.pickup_locations && this.state.company.pickup_locations.length > 0) {\n            this.setState({\n                pickupLocationList: this.state.company.pickup_locations\n            });\n        } else {\n            this.setState({\n                pickupLocationList: tmpLocations\n            })\n        }\n    };\n\n    handleInputFieldChange = (event) => {\n        let params = this.state.params;\n        params[event.target.name] = event.target.value;\n        this.setState({\n            params: params\n            }, () => {console.log(this.state);});\n    };\n\n    showHideLocationMenu = () => {\n        this.setState(\n            (prevState) => ({\n                showLocationPopup: !prevState.showLocationPopup\n            })\n        )\n    };\n\n    updatePickupLocation = (location) => {\n        let params = this.state.params;\n        params.location = location;\n        this.setState({\n            params: params\n        }, () => {\n            this.showHideLocationMenu();\n        })\n    };\n\n    createOrder = () => {\n        PaymentService.createOrder(params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({\n                    cartItems: cartItems,\n                    selectedItemList: cartItems\n                }, () => {\n                    this.CalculateTotalCost(cartItems)\n                });\n            }).catch((error) => {\n            console.error(error);\n        });\n    };\n\n    render(){\n        const selectedList = this.state.selectedList;\n        console.log(selectedList);\n        const pickupLocationList = this.state.pickupLocationList;\n        let locationMenu = undefined;\n        if (pickupLocationList) {\n            locationMenu = pickupLocationList.map((location) =>\n                <ActionSheet\n                    key={location.id}\n                    menus={\n                        [{\n                            label: location.title,\n                            onClick: ()=> {this.updatePickupLocation(location)}\n                        }]\n                    }\n                    actions={\n                        [{\n                            label: '关闭',\n                            onClick: ()=> this.showHideLocationMenu()\n                        }]\n                    }\n                    show={this.state.showLocationPopup}\n                    type=\"ios\"\n                    onRequestClose={()=>this.showHideLocationMenu()}\n                />\n            );\n        }\n\n        return (\n            <div style={styles.viewWrapper}>\n\n                <CellsTitle>取货地点*</CellsTitle>\n                <Cells>\n                    <Cell access>\n                        <CellBody onClick={()=>{this.showHideLocationMenu()}}>\n                            {this.state.params.location.id ?\n                                this.state.params.location.title : <span>请选择取货地点</span>\n                            }\n                        </CellBody>\n                        <CellFooter/>\n                    </Cell>\n                </Cells>\n\n                <CellsTitle>联系方式*</CellsTitle>\n                <Form>\n                    <FormCell>\n                        <CellHeader>\n                            <Label>姓名</Label>\n                        </CellHeader>\n                        <CellBody>\n                            <Input type=\"text\" placeholder=\"请输入姓名\" name='name' value={this.state.contactName}\n                                   onChange={this.handleInputFieldChange}/>\n                        </CellBody>\n                    </FormCell>\n                    <FormCell>\n                        <CellHeader>\n                            <Label>联系电话</Label>\n                        </CellHeader>\n                        <CellBody>\n                            <Input type=\"number\" placeholder=\"请输入手机号\" name='contactNum' value={this.state.contactNum}\n                                   onChange={this.handleInputFieldChange}/>\n                        </CellBody>\n                    </FormCell>\n                    <FormCell>\n                        <CellHeader>\n                            <Label>地址</Label>\n                        </CellHeader>\n                        <CellBody>\n                            <Input type=\"text\" placeholder=\"请输入地址\" name='address'\n                                   value={this.state.contactAddress} onChange={this.handleInputFieldChange}/>\n                        </CellBody>\n                    </FormCell>\n                </Form>\n                <CellsTitle>备注</CellsTitle>\n                <Form>\n                    <FormCell>\n                        <CellBody>\n                            <TextArea placeholder=\"请输入文本\" rows=\"3\" name='notes' value={this.state.notes} onChange={this.handleInputFieldChange}></TextArea>\n                        </CellBody>\n                    </FormCell>\n                </Form>\n\n                <CellsTitle>共{selectedList.length}件商品</CellsTitle>\n                <Cells>\n                    <CheckoutItemList children={selectedList}/>\n                </Cells>\n                <div style={styles.buttonGroupContainer}>\n                    <Button type=\"primary\"\n                            onClick={()=>{this.checkLoginStatus()}}>\n                        确认订单</Button>\n\n                </div>\n                {locationMenu}\n            </div>\n        );\n    }\n}\n\nconst styles = {\n    viewWrapper: {\n        backgroundColor: Colors.formBackground,\n        paddingTop: '1vw'\n    },\n    buttonGroupContainer: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        width: '100%',\n        backgroundColor: '#fff',\n        color: '#fff',\n        textAlign: 'center',\n    }\n};\n\n\nexport default CheckoutView;\n"]},"metadata":{},"sourceType":"module"}