{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/ItemDetails/RegistrationDetails/RegistrationVoucherComponent.js\";\nimport React, { Component } from 'react';\nimport Colors from \"../../../constants/Colors\";\nimport { Cell, CellBody, CellFooter, Cells, Gallery } from \"react-weui\";\nimport JielongService from \"../../../service/JielongService\";\n\nvar RegistrationVoucherComponent =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(RegistrationVoucherComponent, _Component);\n\n  function RegistrationVoucherComponent(props) {\n    var _this;\n\n    _classCallCheck(this, RegistrationVoucherComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RegistrationVoucherComponent).call(this, props));\n    _this.state = {\n      isLogin: _this.props.isLogin,\n      showVoucher: false,\n      item: _this.props.item,\n      callbackUpdateIsParticipated: _this.props.callbackUpdateIsParticipated\n    };\n    return _this;\n  }\n\n  _createClass(RegistrationVoucherComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getAllJielong();\n    }\n  }, {\n    key: \"getAllJielong\",\n    value: function getAllJielong() {\n      var _this2 = this;\n\n      var id = this.state.item.id;\n      JielongService.getAllJielong(id).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        var currentId = responseJson.length - 1;\n\n        _this2.setState({\n          allJielongInfo: responseJson,\n          processAllJieLong: true,\n          userJieLongInfo: responseJson[currentId]\n        }, function () {\n          if (responseJson && responseJson.length > 0) {\n            _this2.state.callbackUpdateIsParticipated(true);\n          } else {\n            _this2.state.callbackUpdateIsParticipated(false);\n          }\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"showHideJieLongMenu\",\n    value: function showHideJieLongMenu() {\n      this.setState(function (prevState) {\n        return {\n          showMenu: !prevState.showMenu\n        };\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var item = this.state.item ? this.state.item : undefined;\n      var allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n      var showDivider = !!this.props.showDivider;\n\n      if (allJielongInfo) {\n        return React.createElement(\"div\", {\n          key: item.id,\n          style: styles.cellWrapper,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 58\n          },\n          __self: this\n        }, allJielongInfo.map(function (jieLong) {\n          return React.createElement(\"div\", {\n            key: jieLong.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 61\n            },\n            __self: this\n          }, React.createElement(Cell, {\n            href: undefined,\n            onClick: function onClick(e) {\n              return _this3.setState({\n                showVoucher: true\n              });\n            },\n            access: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 62\n            },\n            __self: this\n          }, React.createElement(CellBody, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 63\n            },\n            __self: this\n          }, jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum && jieLong.is_paid ? React.createElement(\"div\", {\n            className: \"allJielongInfo\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 66\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"paidAmount-icon\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67\n            },\n            __self: this\n          }, \"\\u5DF2\\u652F\\u4ED8\\uFF1A$\", jieLong.voucher.receipt.amount), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n            className: \"Ref-num\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67\n            },\n            __self: this\n          }, jieLong.voucher.refnum))) : React.createElement(\"div\", {\n            className: \"isInJielong-row\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 70\n            },\n            __self: this\n          }, jieLong.voucher && jieLong.voucher.refnum ? React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 73\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            className: \"tag-icon\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 73\n            },\n            __self: this\n          }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n            className: \"Ref-num\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 73\n            },\n            __self: this\n          }, jieLong.voucher.refnum)) : React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 75\n            },\n            __self: this\n          }, \"\\u63D0\\u793A\\uFF1A\\u60A8\\u6709\\u8BA2\\u5355\\u672A\\u5B8C\\u6210\\uFF0C\\u8BF7\\u572830\\u5206\\u949F\\u5185\\u5B8C\\u6210\\u652F\\u4ED8\\u3002\"))), React.createElement(CellFooter, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 80\n            },\n            __self: this\n          })), React.createElement(Gallery, {\n            src: jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined,\n            show: _this3.state.showVoucher,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 82\n            },\n            __self: this\n          }, React.createElement(\"div\", {\n            style: styles.galleryButton,\n            onClick: function onClick(e) {\n              return _this3.setState({\n                showVoucher: false\n              });\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 83\n            },\n            __self: this\n          }, \"Cancel\")));\n        }), showDivider ? React.createElement(\"div\", {\n          style: Colors.style.bottomDivider,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, \" \") : null);\n      } else return null;\n    }\n  }]);\n\n  return RegistrationVoucherComponent;\n}(Component);\n\nvar styles = {\n  cellWrapper: {\n    backgroundColor: '#fff'\n  }\n};\nexport default RegistrationVoucherComponent;","map":{"version":3,"sources":["/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/ItemDetails/RegistrationDetails/RegistrationVoucherComponent.js"],"names":["React","Component","Colors","Cell","CellBody","CellFooter","Cells","Gallery","JielongService","RegistrationVoucherComponent","props","state","isLogin","showVoucher","item","callbackUpdateIsParticipated","getAllJielong","id","then","response","json","responseJson","currentId","length","setState","allJielongInfo","processAllJieLong","userJieLongInfo","catch","error","console","prevState","showMenu","undefined","showDivider","styles","cellWrapper","map","jieLong","e","is_paid","voucher","receipt","amount","refnum","img_url","galleryButton","style","bottomDivider","backgroundColor"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport Colors from \"../../../constants/Colors\";\nimport {Cell, CellBody, CellFooter, Cells, Gallery} from \"react-weui\";\nimport JielongService from \"../../../service/JielongService\"\n\n\nclass RegistrationVoucherComponent extends Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            isLogin: this.props.isLogin,\n            showVoucher: false,\n            item: this.props.item,\n            callbackUpdateIsParticipated: this.props.callbackUpdateIsParticipated\n        };\n    }\n\n    componentDidMount() {\n        this.getAllJielong()\n    }\n\n    getAllJielong() {\n        let id = this.state.item.id;\n        JielongService.getAllJielong(id)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                let currentId = responseJson.length - 1;\n                this.setState({\n                    allJielongInfo: responseJson,\n                    processAllJieLong: true,\n                    userJieLongInfo : responseJson[currentId],\n                }, () => {\n                    if (responseJson && responseJson.length > 0) {\n                        this.state.callbackUpdateIsParticipated(true)\n                    } else {\n                        this.state.callbackUpdateIsParticipated(false)\n                    }\n\n                });\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    showHideJieLongMenu() {\n        this.setState((prevState) => ({\n            showMenu: !prevState.showMenu\n        }));\n    };\n\n    render(){\n        const item = this.state.item ? this.state.item : undefined;\n        const allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n        const showDivider = !!this.props.showDivider\n        if (allJielongInfo) {\n            return (\n                <div key={item.id} style={styles.cellWrapper}>\n                    {\n                        allJielongInfo.map((jieLong) =>\n                            <div key={jieLong.id}>\n                                <Cell href={undefined} onClick={e=>this.setState({ showVoucher: true})} access>\n                                    <CellBody>\n                                        {\n                                            jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum && jieLong.is_paid?\n                                                <div className='allJielongInfo'>\n                                                    <div><span className='paidAmount-icon'>已支付：${jieLong.voucher.receipt.amount}</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                </div>\n                                                :\n                                                <div className='isInJielong-row'>\n                                                    {\n                                                        jieLong.voucher && jieLong.voucher.refnum ?\n                                                            <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                            :\n                                                            <div>提示：您有订单未完成，请在30分钟内完成支付。</div>\n                                                    }\n                                                </div>\n                                        }\n                                    </CellBody>\n                                    <CellFooter/>\n                                </Cell>\n                                <Gallery src={jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined} show={this.state.showVoucher}>\n                                    <div style={styles.galleryButton} onClick={e=>this.setState({ showVoucher: false})}>Cancel</div>\n                                </Gallery>\n                            </div>\n                        )\n                    }\n\n                    {showDivider ? <div style={Colors.style.bottomDivider}> </div> : null}\n                </div>\n            )\n        } else return null\n\n    }\n}\n\nconst styles = {\n    cellWrapper: {\n        backgroundColor: '#fff'\n    }\n};\n\nexport default RegistrationVoucherComponent;\n\n"]},"metadata":{},"sourceType":"module"}