{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/Zac/Sysbox/SHM_React/shm-react/my-app/pages/index.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport { Cells, Cell, CellBody, CellFooter, Gallery } from 'react-weui';\nimport ItemService from '../service/ItemService';\nimport JielongService from '../service/JielongService';\nimport Router from 'next/router';\nimport SiteHeader from '../components/Common/SiteHeader';\nimport Link from 'next/link'; //import styles\n\nimport 'weui';\nimport 'react-weui/build/packages/react-weui.css'; //import component\n\nimport Head from \"../components/head\";\nimport ChildrenList from '../components/JieLongDetails/ChildrenList';\nimport JielongContent from '../components/JieLongDetails/JieLongContent';\nimport Footer from \"../components/Footer\";\nimport Lang from '../lang/Lang';\nimport JieLongBanner from \"../components/JieLongDetails/JieLongBanner\";\nimport JieLongButtonArea from \"../components/JieLongDetails/JieLongButtonArea\";\nimport JieLongPopUpMenu from \"../components/JieLongDetails/JieLongPopUpMenu\";\nimport JieLongRelatedProducts from \"../components/JieLongDetails/JieLongRelatedProducts\";\nimport Colors from \"../constants/Colors\";\nimport JieLongCompanyInfo from \"../components/JieLongDetails/JieLongCompanyInfo\";\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      item: _this.props.item,\n      isLogin: false,\n      showVoucher: false\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        isLogin: localStorage.getItem('isLogIn')\n      }); // this.getIsInCurrentJieLong();\n\n      if (this.state.item.multi_participations) {\n        this.getAllJielong();\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(object, nextProps) {\n      this.setState({\n        item: object.item\n      });\n    }\n  }, {\n    key: \"getIsInCurrentJieLong\",\n    value: function getIsInCurrentJieLong() {\n      var _this2 = this;\n\n      var id = this.state.item.id;\n      var isLogIn = localStorage.getItem('isLogIn');\n\n      if (isLogIn) {\n        JielongService.getIsInCurrentJieLong(id).then(function (response) {\n          return response.json();\n        }).then(function (responseJson) {\n          _this2.setState({\n            userJieLongInfo: responseJson,\n            processInJieLong: true\n          });\n        }).catch(function (error) {\n          console.error(error);\n        });\n      }\n    }\n  }, {\n    key: \"getAllJielong\",\n    value: function getAllJielong() {\n      var _this3 = this;\n\n      var id = this.state.item.id;\n      var isLogIn = localStorage.getItem('isLogIn');\n\n      if (isLogIn) {\n        JielongService.getAllJielong(id).then(function (response) {\n          return response.json();\n        }).then(function (responseJson) {\n          var currentId = responseJson.length;\n\n          _this3.setState({\n            allJielongInfo: responseJson,\n            processAllJieLong: true,\n            userJieLongInfo: responseJson[currentId],\n            processInJieLong: true\n          });\n        }).catch(function (error) {\n          console.error(error);\n        });\n      }\n    }\n  }, {\n    key: \"showHideMenu\",\n    value: function showHideMenu() {\n      this.setState({\n        iosShow: !this.state.iosShow\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var item = this.state.item ? this.state.item : undefined;\n      var allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n      var showLoading = this.state.showLoading ? this.state.showLoading : false;\n      var iosShow = typeof this.state.iosShow !== 'undefined' ? this.state.iosShow : false;\n      var userJieLongInfo = this.state.userJieLongInfo ? this.state.userJieLongInfo : '';\n      var isLogin = this.state.isLogIn;\n      var loadingJieLong = this.state.processAllJieLong !== this.state.processInJieLong;\n      console.log(isLogin && allJielongInfo);\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(SiteHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"App-body\",\n        key: item.id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(JieLongBanner, {\n        images: item.images,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), React.createElement(JielongContent, {\n        jieLongDetail: item ? item : undefined,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }), userJieLongInfo && userJieLongInfo.currentUserJieLong && userJieLongInfo.currentUserJieLong.voucher && userJieLongInfo.currentUserJieLong.voucher.refnum && !item.multi_participations ? React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(Cell, {\n        href: userJieLongInfo.currentUserJieLong.voucher.img_url,\n        access: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(CellBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"isInJielong-row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"tag-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n        className: \"Ref-num\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, userJieLongInfo.currentUserJieLong.voucher.refnum)))), React.createElement(CellFooter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }))) : null, React.createElement(Cells, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, allJielongInfo ? allJielongInfo.map(function (jieLong) {\n        return React.createElement(\"div\", {\n          key: jieLong.id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }, React.createElement(Cell, {\n          href: undefined,\n          onClick: function onClick(e) {\n            return _this4.setState({\n              showVoucher: true\n            });\n          },\n          access: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, React.createElement(CellBody, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          className: \"allJielongInfo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"paidAmount-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"\\u5DF2\\u652F\\u4ED8\\uFF1A$\", jieLong.voucher.receipt.amount), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, jieLong.voucher.refnum))) : React.createElement(\"div\", {\n          className: \"isInJielong-row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, jieLong.voucher && jieLong.voucher.refnum ? React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"tag-icon\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, \"\\u53C2\\u52A0\\u6210\\u529F\"), \" \\u56DE\\u6267\\u7801\\uFF1A\", React.createElement(\"span\", {\n          className: \"Ref-num\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, jieLong.voucher.refnum)) : React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, \"\\u63D0\\u793A\\uFF1A\\u60A8\\u6709\\u8BA2\\u5355\\u672A\\u5B8C\\u6210\\uFF0C\\u8BF7\\u572830\\u5206\\u949F\\u5185\\u5B8C\\u6210\\u652F\\u4ED8\\u3002\"))), React.createElement(CellFooter, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        })), React.createElement(Gallery, {\n          src: jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined,\n          show: _this4.state.showVoucher,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          style: styles.galleryButton,\n          onClick: function onClick(e) {\n            return _this4.setState({\n              showVoucher: false\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, \"Cancel\")));\n      }) : null), React.createElement(ChildrenList, {\n        children: item.children ? item.children : undefined,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), React.createElement(JieLongCompanyInfo, {\n        item: item,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }), React.createElement(JieLongRelatedProducts, {\n        companyId: item.company_id,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }), React.createElement(JieLongButtonArea, {\n        item: item,\n        isLogin: isLogin,\n        userJieLongInfo: userJieLongInfo,\n        loadingJieLong: loadingJieLong,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }), React.createElement(JieLongPopUpMenu, {\n        item: item,\n        showHideMenu: function showHideMenu() {\n          _this4.showHideMenu();\n        },\n        showLoading: showLoading,\n        iosShow: iosShow,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      })), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\n_defineProperty(App, \"getInitialProps\",\n/*#__PURE__*/\nfunction () {\n  var _ref2 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref) {\n    var req, query, res, json;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            req = _ref.req, query = _ref.query;\n            res = '';\n\n            if (!query.itemId) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 5;\n            return ItemService.getItemDetail(query.itemId);\n\n          case 5:\n            res = _context.sent;\n            _context.next = 11;\n            break;\n\n          case 8:\n            _context.next = 10;\n            return ItemService.getItemDetail('0f95b4d63b1afa75c3a9e2b3fae27cdf');\n\n          case 10:\n            res = _context.sent;\n\n          case 11:\n            _context.next = 13;\n            return res.json();\n\n          case 13:\n            json = _context.sent;\n            return _context.abrupt(\"return\", {\n              item: json\n            });\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}());\n\nvar styles = {\n  bottomDivider: {\n    clear: 'both',\n    padding: '3px 0',\n    backgroundColor: Colors.borderColor,\n    display: 'block'\n  },\n  galleryButton: {\n    color: 'white',\n    fontWeight: 'bold',\n    padding: '0'\n  },\n  relatedProductWrapper: {\n    backgroundColor: '#fff',\n    padding: '5vmin'\n  },\n  buttonGroupContainer: {\n    position: 'fixed',\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    backgroundColor: '#fff',\n    color: '#fff',\n    textAlign: 'center'\n  }\n};\nexport default App;","map":{"version":3,"sources":["/Users/Zac/Sysbox/SHM_React/shm-react/my-app/pages/index.js"],"names":["React","Component","Cells","Cell","CellBody","CellFooter","Gallery","ItemService","JielongService","Router","SiteHeader","Link","Head","ChildrenList","JielongContent","Footer","Lang","JieLongBanner","JieLongButtonArea","JieLongPopUpMenu","JieLongRelatedProducts","Colors","JieLongCompanyInfo","App","props","state","item","isLogin","showVoucher","setState","localStorage","getItem","multi_participations","getAllJielong","object","nextProps","id","isLogIn","getIsInCurrentJieLong","then","response","json","responseJson","userJieLongInfo","processInJieLong","catch","error","console","currentId","length","allJielongInfo","processAllJieLong","iosShow","undefined","showLoading","loadingJieLong","log","images","currentUserJieLong","voucher","refnum","img_url","map","jieLong","e","is_paid","receipt","amount","styles","galleryButton","children","company_id","showHideMenu","req","query","res","itemId","getItemDetail","bottomDivider","clear","padding","backgroundColor","borderColor","display","color","fontWeight","relatedProductWrapper","buttonGroupContainer","position","left","bottom","width","textAlign"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport {Cells, Cell, CellBody, CellFooter, Gallery} from 'react-weui';\nimport ItemService from '../service/ItemService';\nimport JielongService from '../service/JielongService';\nimport Router from 'next/router';\nimport SiteHeader from '../components/Common/SiteHeader';\nimport Link from 'next/link';\n\n//import styles\nimport 'weui';\nimport 'react-weui/build/packages/react-weui.css';\n\n//import component\nimport Head from \"../components/head\";\nimport ChildrenList from '../components/JieLongDetails/ChildrenList';\nimport JielongContent from '../components/JieLongDetails/JieLongContent';\nimport Footer from \"../components/Footer\";\nimport Lang from '../lang/Lang';\nimport JieLongBanner from \"../components/JieLongDetails/JieLongBanner\";\nimport JieLongButtonArea from \"../components/JieLongDetails/JieLongButtonArea\";\nimport JieLongPopUpMenu from \"../components/JieLongDetails/JieLongPopUpMenu\";\nimport JieLongRelatedProducts from \"../components/JieLongDetails/JieLongRelatedProducts\";\nimport Colors from \"../constants/Colors\";\nimport JieLongCompanyInfo from \"../components/JieLongDetails/JieLongCompanyInfo\";\n\n\nclass App extends Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            item: this.props.item,\n            isLogin: false,\n            showVoucher: false,\n        };\n    }\n\n    static getInitialProps = async({ req, query }) => {\n        let res = '';\n        if (query.itemId) {\n            res = await ItemService.getItemDetail(query.itemId);\n        }\n        else {\n            // res = await ItemService.getItemDetail('a3067bcbd7521b4965ef8b43394aa011');\n            res = await ItemService.getItemDetail('0f95b4d63b1afa75c3a9e2b3fae27cdf');\n        }\n        const json = await res.json();\n        return { item: json };\n    };\n\n\n    componentDidMount() {\n        this.setState({\n            isLogin: localStorage.getItem('isLogIn'),\n        });\n        // this.getIsInCurrentJieLong();\n        if (this.state.item.multi_participations) {\n            this.getAllJielong();\n        }\n    }\n\n    componentWillReceiveProps(object, nextProps) {\n        this.setState({\n            item: object.item\n        });\n    }\n\n    getIsInCurrentJieLong() {\n        let id = this.state.item.id;\n        const isLogIn = localStorage.getItem('isLogIn');\n        if (isLogIn) {\n            JielongService.getIsInCurrentJieLong(id)\n                .then((response) => response.json())\n                .then((responseJson) => {\n                    this.setState({\n                        userJieLongInfo: responseJson,\n                        processInJieLong: true,\n                    });\n                })\n                .catch((error) => {\n                    console.error(error);\n                });\n        }\n    }\n\n    getAllJielong() {\n        let id = this.state.item.id;\n        const isLogIn = localStorage.getItem('isLogIn');\n        if (isLogIn) {\n            JielongService.getAllJielong(id)\n                .then((response) => response.json())\n                .then((responseJson) => {\n                    let currentId = responseJson.length;\n                    this.setState({\n                        allJielongInfo: responseJson,\n                        processAllJieLong: true,\n                        userJieLongInfo : responseJson[currentId],\n                        processInJieLong: true,\n                    });\n                })\n                .catch((error) => {\n                    console.error(error);\n                });\n        }\n    }\n\n    showHideMenu(){\n        this.setState({\n            iosShow: !this.state.iosShow,\n        });\n    }\n\n    render() {\n        const item = this.state.item ? this.state.item : undefined;\n        const allJielongInfo = this.state.allJielongInfo ? this.state.allJielongInfo : undefined;\n        const showLoading = this.state.showLoading ? this.state.showLoading : false;\n        const iosShow = typeof this.state.iosShow !== 'undefined' ? this.state.iosShow : false;\n        const userJieLongInfo = this.state.userJieLongInfo ? this.state.userJieLongInfo : '';\n        const isLogin = this.state.isLogIn;\n        const loadingJieLong = this.state.processAllJieLong !== this.state.processInJieLong;\n\n        console.log(isLogin && allJielongInfo);\n\n        return (\n            <div className=\"App\">\n                <SiteHeader/>\n                <div className='App-body' key={item.id}>\n                    <JieLongBanner images={item.images}/>\n                    <JielongContent jieLongDetail={item ? item : undefined}/>\n                    {\n                        userJieLongInfo && userJieLongInfo.currentUserJieLong && userJieLongInfo.currentUserJieLong.voucher && userJieLongInfo.currentUserJieLong.voucher.refnum && !item.multi_participations ?\n                            (\n                                <Cells>\n                                    <Cell href={userJieLongInfo.currentUserJieLong.voucher.img_url} access>\n                                        <CellBody>\n                                            <div className='isInJielong-row'>\n                                                <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{userJieLongInfo.currentUserJieLong.voucher.refnum}</span></div>\n                                            </div>\n                                        </CellBody>\n                                        <CellFooter/>\n                                    </Cell>\n                                </Cells>\n                            )\n                            : null\n                    }\n                    <Cells>\n                        {\n                             allJielongInfo ?\n                                allJielongInfo.map((jieLong) =>\n                                    <div key={jieLong.id}>\n                                        <Cell href={undefined} onClick={e=>this.setState({ showVoucher: true})} access>\n                                            <CellBody>\n                                                {\n                                                    jieLong && jieLong.is_paid && jieLong.voucher && jieLong.voucher.receipt && jieLong.voucher.receipt.amount && jieLong.voucher.refnum ?\n                                                        <div className='allJielongInfo'>\n                                                            <div><span className='paidAmount-icon'>已支付：${jieLong.voucher.receipt.amount}</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                        </div>\n                                                        :\n                                                        <div className='isInJielong-row'>\n                                                            {\n                                                                jieLong.voucher && jieLong.voucher.refnum ?\n                                                                    <div><span className='tag-icon'>参加成功</span> 回执码：<span className='Ref-num'>{jieLong.voucher.refnum}</span></div>\n                                                                    :\n                                                                    <div>提示：您有订单未完成，请在30分钟内完成支付。</div>\n                                                            }\n                                                        </div>\n                                                }\n                                            </CellBody>\n                                            <CellFooter/>\n                                        </Cell>\n                                        <Gallery src={jieLong.voucher && jieLong.voucher.img_url ? jieLong.voucher.img_url : undefined} show={this.state.showVoucher}>\n                                            <div style={styles.galleryButton} onClick={e=>this.setState({ showVoucher: false})}>Cancel</div>\n                                        </Gallery>\n                                    </div>\n                                )\n                                :\n                                null\n                        }\n                    </Cells>\n\n                    <ChildrenList children={item.children ? item.children : undefined}/>\n\n                    <JieLongCompanyInfo item={item}/>\n\n                    <JieLongRelatedProducts companyId={item.company_id}/>\n\n                    <JieLongButtonArea\n                        item={item}\n                        isLogin={isLogin}\n                        userJieLongInfo={userJieLongInfo}\n                        loadingJieLong={loadingJieLong}\n                    />\n\n                    <JieLongPopUpMenu\n                        item={item}\n                        showHideMenu={()=>{this.showHideMenu()}}\n                        showLoading={showLoading}\n                        iosShow={iosShow}\n                    />\n\n                </div>\n                <Footer/>\n            </div>\n        );\n    }\n}\n\nconst styles = {\n    bottomDivider: {\n        clear: 'both',\n        padding: '3px 0',\n        backgroundColor: Colors.borderColor,\n        display: 'block'\n    },\n    galleryButton: {\n        color: 'white',\n        fontWeight:'bold',\n        padding: '0',\n    },\n    relatedProductWrapper: {\n        backgroundColor: '#fff',\n        padding: '5vmin'\n    },\n    buttonGroupContainer: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        width: '100%',\n        backgroundColor: '#fff',\n        color: '#fff',\n        textAlign: 'center',\n    }\n};\n\nexport default App;\n\n\n\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}