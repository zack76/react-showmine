{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/ItemDetails/RegistrationDetails/RegistrationButtonArea.js\";\nimport React from 'react';\nimport { Button, ButtonArea, Toast } from \"react-weui\";\nimport Lang from '../../../lang/Lang';\nimport UtilsService from '../../../service/UtilsService';\nimport AuthService from \"../../../service/AuthService\";\nimport CartService from '../../../service/CartService';\nimport Colors from '../../../constants/Colors';\nimport JielongService from \"../../../service/JielongService\";\n\nvar RegistrationButtonArea =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegistrationButtonArea, _React$Component);\n\n  function RegistrationButtonArea(props) {\n    var _this;\n\n    _classCallCheck(this, RegistrationButtonArea);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RegistrationButtonArea).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"createJielongComment\", function () {\n      _this.setState({\n        isLoadingJieLong: true\n      });\n\n      var itemId = _this.state.item.id;\n      var params = {\n        'config': _JSON$stringify(_this.state.formValues),\n        'comments': '',\n        'quantity': 1,\n        'state_redirect_obj': {\n          url: UtilsService.getWebAddress()\n        },\n        'wechat_auth_url': \"https://www.showmine66.com/a/wu?domain=https%253A%252F%252Fwww.showmine66.com&origurl=https%253A%252F%252Fwww.showmine66.com%252Fma%252Fi%252Fdbfcefa936b4cd6d5709953b5ea12673%2523app-top\",\n        'item_url': \"https://www.showmine66.com/ma/i/\" + itemId,\n        'voucher_base_url': \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\",\n        'is_private': false\n      };\n      JielongService.createJielongComment(itemId, params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this.setState({\n          currentJieLong: responseJson\n        });\n\n        _this.generateVoucher(responseJson.id, _this.state.item);\n      }).catch(function (error) {\n        console.error(error);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateJielongComment\", function () {\n      _this.setState({\n        isLoadingJieLong: true\n      }); // TODO change to jieLongId\n\n\n      var jieLongId = _this.state.item.id;\n      var params = {\n        'config': _JSON$stringify(_this.state.formValues),\n        'comments': '',\n        'quantity': 1,\n        'state_redirect_obj': {\n          url: UtilsService.getWebAddress()\n        },\n        'wechat_auth_url': \"https://www.showmine66.com/a/wu?domain=https%253A%252F%252Fwww.showmine66.com&origurl=https%253A%252F%252Fwww.showmine66.com%252Fma%252Fi%252Fdbfcefa936b4cd6d5709953b5ea12673%2523app-top\",\n        'item_url': \"https://www.showmine66.com/ma/i/\" + _this.state.item.id,\n        'voucher_base_url': \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\",\n        'is_private': false\n      };\n      JielongService.updateJielongComment(jieLongId, params).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this.setState({\n          currentJieLong: responseJson\n        });\n\n        _this.generateVoucher(responseJson.id, _this.state.item);\n      }).catch(function (error) {\n        console.error(error);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"generateVoucher\", function (jieLongId, item) {\n      var itemUrl = \"https://www.showmine66.com/ma/i/\" + item.id;\n      var params = {\n        is_update: false,\n        item_url: itemUrl,\n        voucher_base_url: \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\"\n      };\n      JielongService.generateVoucher(params, jieLongId).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this.setState({\n          voucher: responseJson,\n          isLoadingJieLong: false,\n          jieLongSuccess: true\n        }, function () {\n          window.location.reload();\n        });\n      }).catch(function (error) {\n        console.error(error);\n      });\n    });\n\n    _this.state = {\n      item: _this.props.item,\n      isLogin: _this.props.isLogin,\n      formValues: _this.props.formValues,\n      isLoadingJieLong: false,\n      jieLongSuccess: false,\n      isParticipated: _this.props.isParticipated,\n      currentJieLong: {}\n    };\n    return _this;\n  }\n\n  _createClass(RegistrationButtonArea, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps, nextContext) {\n      this.setState({\n        item: nextProps.item,\n        isLogin: nextProps.address,\n        formValues: nextProps.formValues,\n        isParticipated: nextProps.isParticipated\n      });\n    }\n  }, {\n    key: \"cancelJielong\",\n    value: function cancelJielong() {\n      var _this2 = this;\n\n      this.setState({\n        isLoadingJieLong: true\n      }); // TODO change to jieLongId\n\n      var jieLongId = this.state.item.id;\n      var url = \"https://www.showmine66.com/ma/i/\" + this.state.item.id;\n      JielongService.cancelJielong(id, url, {}).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        _this2.setState({\n          showLoading: false\n        });\n\n        window.location.reload();\n      }).catch(function (error) {\n        console.error(error);\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.state.toastTimer && clearTimeout(this.state.toastTimer);\n    }\n  }, {\n    key: \"showLoading\",\n    value: function showLoading() {\n      var _this3 = this;\n\n      this.state.toastTimer = setTimeout(function () {\n        _this3.setState({\n          jieLongSuccess: false\n        });\n      }, 2000);\n    }\n  }, {\n    key: \"test\",\n    value: function test() {\n      this.setState({\n        isLoadingJieLong: false,\n        jieLongSuccess: true\n      }, function () {\n        window.location.reload();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var isParticipated = this.state.isParticipated;\n\n      if (typeof isParticipated === 'undefined') {\n        return null;\n      } else if (isParticipated) {\n        return React.createElement(\"div\", {\n          style: styles.buttonGroupContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(ButtonArea, {\n          direction: \"horizontal\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, React.createElement(Button, {\n          style: styles.btn,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, \"\\u53D6\\u6D88\\u62A5\\u540D\"), React.createElement(Button, {\n          style: styles.btn,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, \"\\u4FEE\\u6539\\u62A5\\u540D\")));\n      } else {\n        return React.createElement(\"div\", {\n          style: styles.buttonGroupContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }, React.createElement(Button, {\n          onClick: function onClick() {\n            _this4.createJielongComment();\n          },\n          style: styles.btn,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162\n          },\n          __self: this\n        }, \"\\u7ACB\\u523B\\u62A5\\u540D\"), React.createElement(Button, {\n          onClick: function onClick() {\n            _this4.test();\n          },\n          style: styles.btn,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163\n          },\n          __self: this\n        }, \"\\u7ACB\\u523B\\u62A5\\u540D\"), React.createElement(Toast, {\n          icon: \"loading\",\n          show: this.state.isLoadingJieLong,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, \"\\u6B63\\u5728\\u53C2\\u52A0\"), React.createElement(Toast, {\n          icon: \"success-no-circle\",\n          show: this.state.jieLongSuccess,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165\n          },\n          __self: this\n        }, \"Done\"));\n      }\n    }\n  }]);\n\n  return RegistrationButtonArea;\n}(React.Component);\n\nvar styles = {\n  buttonGroupContainer: {\n    position: 'fixed',\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    color: '#fff',\n    textAlign: 'center'\n  },\n  btn: {\n    backgroundColor: Colors.appThemeColor,\n    color: Colors.fontColor,\n    fontWeight: 'bold'\n  }\n};\nexport default RegistrationButtonArea;","map":{"version":3,"sources":["/Users/Zac/Sysbox/SHM_React/shm-react/my-app/components/ItemDetails/RegistrationDetails/RegistrationButtonArea.js"],"names":["React","Button","ButtonArea","Toast","Lang","UtilsService","AuthService","CartService","Colors","JielongService","RegistrationButtonArea","props","setState","isLoadingJieLong","itemId","state","item","id","params","formValues","url","getWebAddress","createJielongComment","then","response","json","responseJson","currentJieLong","generateVoucher","catch","error","console","jieLongId","updateJielongComment","itemUrl","is_update","item_url","voucher_base_url","voucher","jieLongSuccess","window","location","reload","isLogin","isParticipated","nextProps","nextContext","address","cancelJielong","showLoading","toastTimer","clearTimeout","setTimeout","styles","buttonGroupContainer","btn","test","Component","position","left","bottom","width","color","textAlign","backgroundColor","appThemeColor","fontColor","fontWeight"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {Button, ButtonArea, Toast} from \"react-weui\"\nimport Lang from '../../../lang/Lang'\nimport UtilsService from '../../../service/UtilsService'\nimport AuthService from \"../../../service/AuthService\"\nimport CartService from '../../../service/CartService'\nimport Colors from '../../../constants/Colors'\nimport JielongService from \"../../../service/JielongService\"\n\nclass RegistrationButtonArea extends React.Component {\n    constructor(props){\n        super(props)\n        this.state = {\n            item: this.props.item,\n            isLogin: this.props.isLogin,\n            formValues: this.props.formValues,\n            isLoadingJieLong: false,\n            jieLongSuccess: false,\n            isParticipated: this.props.isParticipated,\n            currentJieLong: {}\n        }\n    }\n\n    componentWillReceiveProps(nextProps, nextContext) {\n        this.setState({\n            item: nextProps.item,\n            isLogin: nextProps.address,\n            formValues: nextProps.formValues,\n            isParticipated: nextProps.isParticipated\n        })\n    }\n\n    createJielongComment = () => {\n        this.setState({ isLoadingJieLong: true })\n        let itemId = this.state.item.id\n        let params = {\n            'config': JSON.stringify(this.state.formValues),\n            'comments': '',\n            'quantity': 1,\n            'state_redirect_obj': {\n                url: UtilsService.getWebAddress(),\n            },\n            'wechat_auth_url': \"https://www.showmine66.com/a/wu?domain=https%253A%252F%252Fwww.showmine66.com&origurl=https%253A%252F%252Fwww.showmine66.com%252Fma%252Fi%252Fdbfcefa936b4cd6d5709953b5ea12673%2523app-top\",\n            'item_url': \"https://www.showmine66.com/ma/i/\" + itemId,\n            'voucher_base_url': \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\",\n            'is_private': false\n        }\n\n        JielongService.createJielongComment(itemId, params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({ currentJieLong: responseJson })\n                this.generateVoucher(responseJson.id, this.state.item)\n            })\n            .catch((error) => {\n                console.error(error)\n            })\n    }\n\n    updateJielongComment = () => {\n        this.setState({ isLoadingJieLong: true })\n        // TODO change to jieLongId\n        let jieLongId = this.state.item.id\n        let params = {\n            'config': JSON.stringify(this.state.formValues),\n            'comments': '',\n            'quantity': 1,\n            'state_redirect_obj': {\n                url: UtilsService.getWebAddress(),\n            },\n            'wechat_auth_url': \"https://www.showmine66.com/a/wu?domain=https%253A%252F%252Fwww.showmine66.com&origurl=https%253A%252F%252Fwww.showmine66.com%252Fma%252Fi%252Fdbfcefa936b4cd6d5709953b5ea12673%2523app-top\",\n            'item_url': \"https://www.showmine66.com/ma/i/\" + this.state.item.id,\n            'voucher_base_url': \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\",\n            'is_private': false\n        }\n\n        JielongService.updateJielongComment(jieLongId, params)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({ currentJieLong: responseJson })\n                this.generateVoucher(responseJson.id, this.state.item)\n            })\n            .catch((error) => {\n                console.error(error)\n            })\n    }\n\n    cancelJielong() {\n        this.setState({ isLoadingJieLong: true })\n        // TODO change to jieLongId\n        let jieLongId = this.state.item.id\n        let url = \"https://www.showmine66.com/ma/i/\" + this.state.item.id;\n        JielongService.cancelJielong(id, url, {})\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({showLoading: false});\n                window.location.reload();\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n    }\n\n    generateVoucher = (jieLongId, item) => {\n        let itemUrl = \"https://www.showmine66.com/ma/i/\" + item.id\n        let params = {\n            is_update: false,\n            item_url: itemUrl,\n            voucher_base_url: \"https://www.showmine66.com/ma/jl/vci/VOUCHERID\",\n        }\n        JielongService.generateVoucher(params, jieLongId)\n            .then((response) => response.json())\n            .then((responseJson) => {\n                this.setState({\n                    voucher: responseJson,\n                    isLoadingJieLong: false,\n                    jieLongSuccess: true\n                }, () => {\n                    window.location.reload();\n                })\n            })\n            .catch((error) => {\n                console.error(error)\n            })\n    }\n\n    componentWillUnmount() {\n        this.state.toastTimer && clearTimeout(this.state.toastTimer);\n    }\n\n    showLoading() {\n        this.state.toastTimer = setTimeout(()=> {\n            this.setState({jieLongSuccess: false});\n        }, 2000);\n    }\n\n    test() {\n        this.setState({\n            isLoadingJieLong: false,\n            jieLongSuccess: true\n        }, () => {\n            window.location.reload();\n        })\n    }\n\n    render(){\n        const { isParticipated } = this.state\n        if (typeof isParticipated === 'undefined') {\n            return null\n        } else if (isParticipated) {\n            return (\n                <div style={styles.buttonGroupContainer}>\n                    <ButtonArea direction=\"horizontal\">\n                        <Button style={styles.btn}>取消报名</Button>\n                        <Button style={styles.btn}>修改报名</Button>\n                    </ButtonArea>\n                </div>\n            )\n        } else {\n            return (\n                <div style={ styles.buttonGroupContainer }>\n                    <Button onClick={()=>{ this.createJielongComment() }} style={styles.btn}>立刻报名</Button>\n                    <Button onClick={()=>{ this.test() }} style={styles.btn}>立刻报名</Button>\n                    <Toast icon=\"loading\" show={this.state.isLoadingJieLong}>正在参加</Toast>\n                    <Toast icon=\"success-no-circle\" show={this.state.jieLongSuccess}>Done</Toast>\n                </div>\n            )\n        }\n    }\n}\n\nconst styles = {\n    buttonGroupContainer: {\n        position: 'fixed',\n        left: 0,\n        bottom: 0,\n        width: '100%',\n        color: '#fff',\n        textAlign: 'center',\n    },\n    btn: {\n        backgroundColor: Colors.appThemeColor,\n        color: Colors.fontColor,\n        fontWeight: 'bold'\n    },\n}\n\n\nexport default RegistrationButtonArea\n"]},"metadata":{},"sourceType":"module"}